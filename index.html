<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emergency Shelter Finder</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom font import for aesthetics */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        :root {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #6366f1; /* Indigo-500 */
            border-radius: 4px;
        }
        /* Style for the directions button hover effect */
        .directions-btn:hover .icon-arrow {
            transform: translateX(4px);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <div class="max-w-4xl mx-auto p-4 md:p-8">

        <!-- Header -->
        <header class="text-center mb-10 bg-indigo-600 text-white p-6 rounded-xl shadow-lg">
            <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight mb-2">
                Emergency Shelter Finder
            </h1>
            <p class="text-indigo-200 text-lg">
                Find and get directions to the nearest severe weather shelter.
            </p>
        </header>

        <!-- Filter/Search Section -->
        <div class="bg-white p-6 rounded-xl shadow-md mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                <i data-lucide="filter" class="w-5 h-5 mr-2 text-indigo-600"></i>
                Filter Shelters
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Filter by City -->
                <div>
                    <label for="city-input" class="block text-sm font-medium text-gray-700 mb-1">Filter by City Name</label>
                    <input type="text" id="city-input" placeholder="e.g., Springfield" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
                </div>

                <!-- Filter by County -->
                <div>
                    <label for="county-input" class="block text-sm font-medium text-gray-700 mb-1">Filter by County Name</label>
                    <input type="text" id="county-input" placeholder="e.g., Lincoln" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
                </div>
            </div>

            <!-- Result Count and Clear Button -->
            <div class="mt-4 flex justify-between items-center">
                <p id="result-count" class="text-sm font-medium text-indigo-600">Showing 0 shelters.</p>
                <button id="clear-filters" class="text-sm text-gray-500 hover:text-indigo-600 transition duration-150 p-2 rounded-lg">
                    <i data-lucide="refresh-ccw" class="w-4 h-4 inline mr-1"></i>
                    Clear Filters
                </button>
            </div>
        </div>

        <!-- Shelter List Display -->
        <div id="shelter-list" class="space-y-4">
            <!-- Shelter cards will be injected here by JavaScript -->
        </div>

        <!-- Initial/Empty State Message -->
        <div id="empty-state" class="bg-white p-6 rounded-xl shadow-md text-center text-gray-500">
            <i data-lucide="search-check" class="w-10 h-10 mx-auto mb-3 text-indigo-400"></i>
            <p class="text-lg font-semibold">Start searching for shelters above.</p>
            <p class="text-sm mt-1">Results will appear here as you type.</p>
        </div>

        <!-- Footer for context -->
        <footer class="text-center mt-10 text-gray-400 text-xs">
            <p>Note: This application uses mock data for demonstration purposes. In a real application, this data would be sourced from official emergency management agencies.</p>
        </footer>

    </div>

    <script>
        // --- 1. MOCK DATASET ---
        // This array simulates the data you would receive from a real shelter database.
        // The lat/lon coordinates are used to generate the Google Maps directions link.
        const shelters = [
            { id: 1, name: "Community Center Shelter", address: "123 Main St", city: "Springfield", county: "Lincoln", lat: 39.7990, lon: -89.6500, capacity: 500, status: "Open" },
            { id: 2, name: "High School Gym", address: "456 Oak Ave", city: "Springfield", county: "Lincoln", lat: 39.7800, lon: -89.6450, capacity: 800, status: "Open" },
            { id: 3, name: "City Hall Annex", address: "789 Pine Rd", city: "Shelbyville", county: "Franklin", lat: 39.4600, lon: -86.0000, capacity: 300, status: "Limited" },
            { id: 4, name: "Fire Station #5", address: "101 Maple Ln", city: "Capital City", county: "Lincoln", lat: 39.7700, lon: -89.6000, capacity: 50, status: "Open" },
            { id: 5, name: "County Fairgrounds Pavilion", address: "202 Expo Blvd", city: "Ogdenville", county: "Madison", lat: 39.8500, lon: -89.7000, capacity: 1200, status: "Open" },
            { id: 6, name: "Local Library Branch", address: "303 Book St", city: "Shelbyville", county: "Franklin", lat: 39.4550, lon: -86.0100, capacity: 150, status: "Open" },
            { id: 7, name: "Town Hall Basement", address: "404 Civic Center Dr", city: "Brockway", county: "Morgan", lat: 40.0100, lon: -90.1000, capacity: 250, status: "Open" },
            { id: 8, name: "Old Church Building", address: "505 Faith St", city: "Springfield", county: "Lincoln", lat: 39.7900, lon: -89.6300, capacity: 100, status: "Closed" },
        ];

        // --- 2. DOM Elements ---
        const cityInput = document.getElementById('city-input');
        const countyInput = document.getElementById('county-input');
        const shelterList = document.getElementById('shelter-list');
        const emptyState = document.getElementById('empty-state');
        const resultCount = document.getElementById('result-count');
        const clearFiltersButton = document.getElementById('clear-filters');

        // --- 3. HELPER FUNCTIONS ---

        /**
         * Generates the HTML for a single shelter card.
         * @param {object} shelter - The shelter object.
         */
        function createShelterCard(shelter) {
            // Determine badge color based on status
            let statusColor = '';
            switch (shelter.status) {
                case 'Open':
                    statusColor = 'bg-green-100 text-green-800';
                    break;
                case 'Limited':
                    statusColor = 'bg-yellow-100 text-yellow-800';
                    break;
                case 'Closed':
                    statusColor = 'bg-red-100 text-red-800';
                    break;
                default:
                    statusColor = 'bg-gray-100 text-gray-800';
            }

            // Create the Google Maps URL for directions
            const directionsUrl = `https://www.google.com/maps/dir/?api=1&destination=${shelter.lat},${shelter.lon}`;

            return `
                <div class="bg-white p-5 rounded-xl border border-gray-200 hover:shadow-lg transition duration-300">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3">
                        <h3 class="text-xl font-bold text-gray-900">${shelter.name}</h3>
                        <span class="mt-2 sm:mt-0 px-3 py-1 text-xs font-semibold rounded-full ${statusColor}">
                            Status: ${shelter.status}
                        </span>
                    </div>

                    <div class="text-gray-600 space-y-1 mb-4 text-sm">
                        <p class="flex items-center"><i data-lucide="map-pin" class="w-4 h-4 mr-2 text-indigo-500"></i> ${shelter.address}</p>
                        <p class="flex items-center"><i data-lucide="home" class="w-4 h-4 mr-2 text-indigo-500"></i> ${shelter.city}, ${shelter.county} County</p>
                        <p class="flex items-center"><i data-lucide="users" class="w-4 h-4 mr-2 text-indigo-500"></i> Capacity: ${shelter.capacity} (Mock)</p>
                    </div>

                    <a href="${directionsUrl}" target="_blank" class="directions-btn inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 border border-transparent text-sm font-medium rounded-full shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-300 group">
                        Get Directions
                        <i data-lucide="arrow-right" class="icon-arrow w-4 h-4 ml-2 transition-transform duration-300"></i>
                    </a>
                </div>
            `;
        }

        /**
         * Renders the filtered list of shelters to the DOM.
         * @param {Array<object>} filteredShelters - The array of shelters to display.
         */
        function renderShelters(filteredShelters) {
            shelterList.innerHTML = ''; // Clear previous results
            resultCount.textContent = `Showing ${filteredShelters.length} shelters.`;

            if (filteredShelters.length === 0 && (cityInput.value.trim() || countyInput.value.trim())) {
                // If filters are applied but no results found
                emptyState.innerHTML = `
                    <i data-lucide="alert-triangle" class="w-10 h-10 mx-auto mb-3 text-yellow-400"></i>
                    <p class="text-lg font-semibold">No shelters match your criteria.</p>
                    <p class="text-sm mt-1">Try broadening your search or checking spelling.</p>
                `;
                emptyState.classList.remove('hidden');
            } else if (filteredShelters.length === 0) {
                // Initial empty state
                emptyState.innerHTML = `
                    <i data-lucide="search-check" class="w-10 h-10 mx-auto mb-3 text-indigo-400"></i>
                    <p class="text-lg font-semibold">Start searching for shelters above.</p>
                    <p class="text-sm mt-1">Results will appear here as you type.</p>
                `;
                emptyState.classList.remove('hidden');
            } else {
                emptyState.classList.add('hidden');
                // Render the cards
                filteredShelters.forEach(shelter => {
                    shelterList.innerHTML += createShelterCard(shelter);
                });
                // Re-initialize Lucide icons for newly added HTML
                lucide.createIcons();
            }
        }

        /**
         * Main function to filter shelters based on current input values.
         */
        function filterShelters() {
            const cityQuery = cityInput.value.trim().toLowerCase();
            const countyQuery = countyInput.value.trim().toLowerCase();

            const filtered = shelters.filter(shelter => {
                const cityMatch = shelter.city.toLowerCase().includes(cityQuery);
                const countyMatch = shelter.county.toLowerCase().includes(countyQuery);

                // Check if *both* queries match, or if one is empty and the other matches.
                // If both queries are empty, all shelters match.
                if (!cityQuery && !countyQuery) return true;
                if (cityQuery && countyQuery) return cityMatch && countyMatch;
                if (cityQuery) return cityMatch;
                if (countyQuery) return countyMatch;
            });

            renderShelters(filtered);
        }

        /**
         * Clears all filters and re-renders the full list.
         */
        function clearFilters() {
            cityInput.value = '';
            countyInput.value = '';
            filterShelters(); // Re-run filter, which will now show all
        }

        // --- 4. EVENT LISTENERS & INITIALIZATION ---

        // Listen for input changes in both fields
        cityInput.addEventListener('input', filterShelters);
        countyInput.addEventListener('input', filterShelters);

        // Listen for the clear button click
        clearFiltersButton.addEventListener('click', clearFilters);

        // Initial render of all shelters when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            filterShelters();
            // Also initialize Lucide icons for the static header/filter section
            lucide.createIcons();
        });

    </script>
</body>
</html>
